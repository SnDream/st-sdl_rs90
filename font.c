#include <SDL/SDL.h>
#include "font.h"
#include "utf8_utils.h"

static const unsigned char embedded_font[] = {
	0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
	0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
	0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
	0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
	0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
	0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
	0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
	0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
	0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
	0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
	0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
	0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
	0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
	0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
	0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
	0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
	0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
	0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
	0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
	0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
	0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
	0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
	0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
	0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
	0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
	0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
	0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
	0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
	0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
	0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
	0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
	0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
	0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
	0x40, 0x40, 0x40, 0x00, 0x40, 0x00, 0x00, 0x00,
	0xa0, 0xa0, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
	0xa0, 0xe0, 0xa0, 0xe0, 0xa0, 0x00, 0x00, 0x00,
	0x40, 0x60, 0x40, 0xc0, 0x40, 0x00, 0x00, 0x00,
	0x80, 0x20, 0x40, 0x80, 0x20, 0x00, 0x00, 0x00,
	0xc0, 0xc0, 0xa0, 0x40, 0xa0, 0x00, 0x00, 0x00,
	0x40, 0x80, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
	0x20, 0x40, 0x40, 0x40, 0x20, 0x00, 0x00, 0x00,
	0x80, 0x40, 0x40, 0x40, 0x80, 0x00, 0x00, 0x00,
	0x00, 0xF0, 0xF0, 0xF0, 0xF0, 0x00, 0x00, 0x00, // 0x00, 0xa0, 0x40, 0xa0, 0x00, 0x00, 0x00, 0x00,
	0x00, 0x40, 0xe0, 0x40, 0x00, 0x00, 0x00, 0x00,
	0x00, 0x00, 0x00, 0x40, 0x80, 0x00, 0x00, 0x00,
	0x00, 0x00, 0xe0, 0x00, 0x00, 0x00, 0x00, 0x00,
	0x00, 0x00, 0x00, 0x00, 0x40, 0x00, 0x00, 0x00,
	0x20, 0x20, 0x40, 0x40, 0x80, 0x80, 0x00, 0x00,
	0xe0, 0xa0, 0xa0, 0xa0, 0xe0, 0x00, 0x00, 0x00,
	0x40, 0xc0, 0x40, 0x40, 0xe0, 0x00, 0x00, 0x00,
	0xe0, 0x20, 0xe0, 0x80, 0xe0, 0x00, 0x00, 0x00,
	0xe0, 0x20, 0xe0, 0x20, 0xe0, 0x00, 0x00, 0x00,
	0xa0, 0xa0, 0xe0, 0x20, 0x20, 0x00, 0x00, 0x00,
	0xe0, 0x80, 0xe0, 0x20, 0xe0, 0x00, 0x00, 0x00,
	0xe0, 0x80, 0xe0, 0xa0, 0xe0, 0x00, 0x00, 0x00,
	0xe0, 0x20, 0x20, 0x20, 0x20, 0x00, 0x00, 0x00,
	0xe0, 0xa0, 0xe0, 0xa0, 0xe0, 0x00, 0x00, 0x00,
	0xe0, 0xa0, 0xe0, 0x20, 0xe0, 0x00, 0x00, 0x00,
	0x00, 0x40, 0x00, 0x40, 0x00, 0x00, 0x00, 0x00,
	0x00, 0x40, 0x00, 0x40, 0x80, 0x00, 0x00, 0x00,
	0x20, 0x40, 0x80, 0x40, 0x20, 0x00, 0x00, 0x00,
	0x00, 0xe0, 0x00, 0xe0, 0x00, 0x00, 0x00, 0x00,
	0x80, 0x40, 0x20, 0x40, 0x80, 0x00, 0x00, 0x00,
	0xc0, 0x20, 0x40, 0x00, 0x40, 0x00, 0x00, 0x00,
	0x40, 0xa0, 0xa0, 0x80, 0x60, 0x00, 0x00, 0x00,
	0x40, 0xa0, 0xa0, 0xe0, 0xa0, 0x00, 0x00, 0x00,
	0xc0, 0xa0, 0xc0, 0xa0, 0xc0, 0x00, 0x00, 0x00,
	0x60, 0x80, 0x80, 0x80, 0x60, 0x00, 0x00, 0x00,
	0xc0, 0xa0, 0xa0, 0xa0, 0xc0, 0x00, 0x00, 0x00,
	0xe0, 0x80, 0xc0, 0x80, 0xe0, 0x00, 0x00, 0x00,
	0xe0, 0x80, 0xc0, 0x80, 0x80, 0x00, 0x00, 0x00,
	0x60, 0x80, 0xa0, 0xa0, 0x60, 0x00, 0x00, 0x00,
	0xa0, 0xa0, 0xe0, 0xa0, 0xa0, 0x00, 0x00, 0x00,
	0xe0, 0x40, 0x40, 0x40, 0xe0, 0x00, 0x00, 0x00,
	0x60, 0x20, 0x20, 0xa0, 0x40, 0x00, 0x00, 0x00,
	0xa0, 0xa0, 0xc0, 0xa0, 0xa0, 0x00, 0x00, 0x00,
	0x80, 0x80, 0x80, 0x80, 0xe0, 0x00, 0x00, 0x00,
	0xa0, 0xe0, 0xe0, 0xa0, 0xa0, 0x00, 0x00, 0x00,
	0xc0, 0xa0, 0xa0, 0xa0, 0xa0, 0x00, 0x00, 0x00,
	0x40, 0xa0, 0xa0, 0xa0, 0x40, 0x00, 0x00, 0x00,
	0xc0, 0xa0, 0xc0, 0x80, 0x80, 0x00, 0x00, 0x00,
	0x40, 0xa0, 0xa0, 0xc0, 0x60, 0x00, 0x00, 0x00,
	0xc0, 0xa0, 0xc0, 0xa0, 0xa0, 0x00, 0x00, 0x00,
	0x60, 0x80, 0x40, 0x20, 0xc0, 0x00, 0x00, 0x00,
	0xe0, 0x40, 0x40, 0x40, 0x40, 0x00, 0x00, 0x00,
	0xa0, 0xa0, 0xa0, 0xa0, 0x60, 0x00, 0x00, 0x00,
	0xa0, 0xa0, 0xa0, 0xa0, 0x40, 0x00, 0x00, 0x00,
	0xa0, 0xa0, 0xe0, 0xe0, 0xa0, 0x00, 0x00, 0x00,
	0xa0, 0xa0, 0x40, 0xa0, 0xa0, 0x00, 0x00, 0x00,
	0xa0, 0xa0, 0x40, 0x40, 0x40, 0x00, 0x00, 0x00,
	0xe0, 0x20, 0x40, 0x80, 0xe0, 0x00, 0x00, 0x00,
	0x60, 0x40, 0x40, 0x40, 0x60, 0x00, 0x00, 0x00,
	0x80, 0x80, 0x40, 0x40, 0x20, 0x20, 0x00, 0x00,
	0xc0, 0x40, 0x40, 0x40, 0xc0, 0x00, 0x00, 0x00,
	0x40, 0xa0, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
	0x00, 0x00, 0x00, 0x00, 0xe0, 0x00, 0x00, 0x00,
	0x80, 0x40, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
	0x40, 0x20, 0x60, 0xa0, 0x60, 0x00, 0x00, 0x00,
	0x80, 0x80, 0xc0, 0xa0, 0xc0, 0x00, 0x00, 0x00,
	0x00, 0x60, 0x80, 0x80, 0x60, 0x00, 0x00, 0x00,
	0x20, 0x20, 0x60, 0xa0, 0x60, 0x00, 0x00, 0x00,
	0x00, 0x40, 0xe0, 0x80, 0x60, 0x00, 0x00, 0x00,
	0x20, 0x40, 0xe0, 0x40, 0x40, 0x00, 0x00, 0x00,
	0x00, 0x60, 0xa0, 0xe0, 0x20, 0xc0, 0x00, 0x00,
	0x80, 0x80, 0xc0, 0xa0, 0xa0, 0x00, 0x00, 0x00,
	0x40, 0x00, 0xc0, 0x40, 0xe0, 0x00, 0x00, 0x00,
	0x20, 0x00, 0x60, 0x20, 0xa0, 0x40, 0x00, 0x00,
	0x80, 0xa0, 0xc0, 0xa0, 0xa0, 0x00, 0x00, 0x00,
	0x80, 0x80, 0x80, 0x80, 0x60, 0x00, 0x00, 0x00,
	0x00, 0xe0, 0xe0, 0xa0, 0xa0, 0x00, 0x00, 0x00,
	0x00, 0xc0, 0xa0, 0xa0, 0xa0, 0x00, 0x00, 0x00,
	0x00, 0x40, 0xa0, 0xa0, 0x40, 0x00, 0x00, 0x00,
	0x00, 0xc0, 0xa0, 0xc0, 0x80, 0x80, 0x00, 0x00,
	0x00, 0x60, 0xa0, 0x60, 0x20, 0x20, 0x00, 0x00,
	0x00, 0xc0, 0xa0, 0x80, 0x80, 0x00, 0x00, 0x00,
	0x00, 0x60, 0xc0, 0x20, 0xc0, 0x00, 0x00, 0x00,
	0x40, 0xe0, 0x40, 0x40, 0x20, 0x00, 0x00, 0x00,
	0x00, 0xa0, 0xa0, 0xa0, 0x60, 0x00, 0x00, 0x00,
	0x00, 0xa0, 0xa0, 0xa0, 0x40, 0x00, 0x00, 0x00,
	0x00, 0xa0, 0xa0, 0xe0, 0xe0, 0x00, 0x00, 0x00,
	0x00, 0xa0, 0x40, 0xa0, 0xa0, 0x00, 0x00, 0x00,
	0x00, 0xa0, 0xa0, 0x60, 0x20, 0xc0, 0x00, 0x00,
	0x00, 0xe0, 0x20, 0x40, 0xe0, 0x00, 0x00, 0x00,
	0x60, 0x40, 0x80, 0x40, 0x60, 0x00, 0x00, 0x00,
	0x40, 0x40, 0x40, 0x40, 0x40, 0x00, 0x00, 0x00,
	0xc0, 0x40, 0x20, 0x40, 0xc0, 0x00, 0x00, 0x00,
	0x60, 0xc0, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
	0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
};

static const unsigned char boxdrawing_font[] = {
	0x00, 0x00, 0xf0, 0x00, 0x00, 0x00, 0x00, 0x00,
	0x00, 0x00, 0xf0, 0xf0, 0x00, 0x00, 0x00, 0x00,
	0x40, 0x40, 0x40, 0x40, 0x40, 0x40, 0x00, 0x00,
	0x60, 0x60, 0x60, 0x60, 0x60, 0x60, 0x00, 0x00,
	0x00, 0x00, 0xa0, 0x00, 0x00, 0x00, 0x00, 0x00,
	0x00, 0x00, 0xa0, 0xa0, 0x00, 0x00, 0x00, 0x00,
	0x40, 0x00, 0x40, 0x00, 0x40, 0x00, 0x00, 0x00,
	0x60, 0x00, 0x60, 0x00, 0x60, 0x00, 0x00, 0x00,
	0x00, 0x00, 0xa0, 0x00, 0x00, 0x00, 0x00, 0x00,
	0x00, 0x00, 0xa0, 0xa0, 0x00, 0x00, 0x00, 0x00,
	0x40, 0x00, 0x40, 0x00, 0x40, 0x00, 0x00, 0x00,
	0x60, 0x00, 0x60, 0x00, 0x60, 0x00, 0x00, 0x00,
	0x00, 0x00, 0x70, 0x40, 0x40, 0x40, 0x00, 0x00,
	0x00, 0x00, 0x70, 0x70, 0x40, 0x40, 0x00, 0x00,
	0x00, 0x00, 0x70, 0x60, 0x60, 0x60, 0x00, 0x00,
	0x00, 0x00, 0x70, 0x70, 0x60, 0x60, 0x00, 0x00,
	0x00, 0x00, 0xc0, 0x40, 0x40, 0x40, 0x00, 0x00,
	0x00, 0x00, 0xc0, 0xc0, 0x40, 0x40, 0x00, 0x00,
	0x00, 0x00, 0xe0, 0x60, 0x60, 0x60, 0x00, 0x00,
	0x00, 0x00, 0xe0, 0xe0, 0x60, 0x60, 0x00, 0x00,
	0x40, 0x40, 0x70, 0x00, 0x00, 0x00, 0x00, 0x00,
	0x40, 0x40, 0x70, 0x70, 0x00, 0x00, 0x00, 0x00,
	0x60, 0x60, 0x70, 0x00, 0x00, 0x00, 0x00, 0x00,
	0x60, 0x60, 0x70, 0x70, 0x00, 0x00, 0x00, 0x00,
	0x40, 0x40, 0xc0, 0x00, 0x00, 0x00, 0x00, 0x00,
	0x40, 0x40, 0xc0, 0xc0, 0x00, 0x00, 0x00, 0x00,
	0x60, 0x60, 0xe0, 0x00, 0x00, 0x00, 0x00, 0x00,
	0x60, 0x60, 0xe0, 0xe0, 0x00, 0x00, 0x00, 0x00,
	0x40, 0x40, 0x70, 0x40, 0x40, 0x40, 0x00, 0x00,
	0x40, 0x40, 0x70, 0x70, 0x40, 0x40, 0x00, 0x00,
	0x60, 0x60, 0x70, 0x40, 0x40, 0x40, 0x00, 0x00,
	0x40, 0x40, 0x70, 0x60, 0x60, 0x60, 0x00, 0x00,
	0x60, 0x60, 0x70, 0x60, 0x60, 0x60, 0x00, 0x00,
	0x60, 0x60, 0x70, 0x70, 0x40, 0x40, 0x00, 0x00,
	0x40, 0x40, 0x70, 0x70, 0x60, 0x60, 0x00, 0x00,
	0x60, 0x60, 0x70, 0x70, 0x60, 0x60, 0x00, 0x00,
	0x40, 0x40, 0xc0, 0x40, 0x40, 0x40, 0x00, 0x00,
	0x40, 0x40, 0xc0, 0xc0, 0x40, 0x40, 0x00, 0x00,
	0x60, 0x60, 0xe0, 0x40, 0x40, 0x40, 0x00, 0x00,
	0x40, 0x40, 0xe0, 0x60, 0x60, 0x60, 0x00, 0x00,
	0x60, 0x60, 0xe0, 0x60, 0x60, 0x60, 0x00, 0x00,
	0x60, 0x60, 0xe0, 0xe0, 0x40, 0x40, 0x00, 0x00,
	0x40, 0x40, 0xe0, 0xe0, 0x60, 0x60, 0x00, 0x00,
	0x60, 0x60, 0xe0, 0xe0, 0x60, 0x60, 0x00, 0x00,
	0x00, 0x00, 0xf0, 0x40, 0x40, 0x40, 0x00, 0x00,
	0x00, 0x00, 0xf0, 0xc0, 0x40, 0x40, 0x00, 0x00,
	0x00, 0x00, 0xf0, 0x70, 0x40, 0x40, 0x00, 0x00,
	0x00, 0x00, 0xf0, 0xf0, 0x40, 0x40, 0x00, 0x00,
	0x00, 0x00, 0xf0, 0x60, 0x60, 0x60, 0x00, 0x00,
	0x00, 0x00, 0xf0, 0xe0, 0x60, 0x60, 0x00, 0x00,
	0x00, 0x00, 0xf0, 0x70, 0x60, 0x60, 0x00, 0x00,
	0x00, 0x00, 0xf0, 0xf0, 0x60, 0x60, 0x00, 0x00,
	0x40, 0x40, 0xf0, 0x00, 0x00, 0x00, 0x00, 0x00,
	0x40, 0x40, 0xf0, 0xc0, 0x00, 0x00, 0x00, 0x00,
	0x40, 0x40, 0xf0, 0x70, 0x00, 0x00, 0x00, 0x00,
	0x40, 0x40, 0xf0, 0xf0, 0x00, 0x00, 0x00, 0x00,
	0x60, 0x60, 0xf0, 0x00, 0x00, 0x00, 0x00, 0x00,
	0x60, 0x60, 0xf0, 0xe0, 0x00, 0x00, 0x00, 0x00,
	0x60, 0x60, 0xf0, 0x70, 0x00, 0x00, 0x00, 0x00,
	0x60, 0x60, 0xf0, 0xf0, 0x00, 0x00, 0x00, 0x00,
	0x40, 0x40, 0xf0, 0x40, 0x40, 0x40, 0x00, 0x00,
	0x40, 0x40, 0xf0, 0xc0, 0x40, 0x40, 0x00, 0x00,
	0x40, 0x40, 0xf0, 0x70, 0x40, 0x40, 0x00, 0x00,
	0x40, 0x40, 0xf0, 0xf0, 0x40, 0x40, 0x00, 0x00,
	0x60, 0x60, 0xf0, 0x40, 0x40, 0x40, 0x00, 0x00,
	0x40, 0x40, 0xf0, 0x60, 0x60, 0x60, 0x00, 0x00,
	0x60, 0x60, 0xf0, 0x60, 0x60, 0x60, 0x00, 0x00,
	0x60, 0x60, 0xf0, 0xe0, 0x40, 0x40, 0x00, 0x00,
	0x60, 0x60, 0xf0, 0x70, 0x40, 0x40, 0x00, 0x00,
	0x40, 0x40, 0xf0, 0xe0, 0x60, 0x60, 0x00, 0x00,
	0x40, 0x40, 0xf0, 0x70, 0x60, 0x60, 0x00, 0x00,
	0x60, 0x60, 0xf0, 0xf0, 0x40, 0x40, 0x00, 0x00,
	0x40, 0x40, 0xf0, 0xf0, 0x60, 0x60, 0x00, 0x00,
	0x60, 0x60, 0xf0, 0xe0, 0x60, 0x60, 0x00, 0x00,
	0x60, 0x60, 0xf0, 0x70, 0x60, 0x60, 0x00, 0x00,
	0x60, 0x60, 0xf0, 0xf0, 0x60, 0x60, 0x00, 0x00,
	0x00, 0x00, 0xa0, 0x00, 0x00, 0x00, 0x00, 0x00,
	0x00, 0x00, 0xa0, 0xa0, 0x00, 0x00, 0x00, 0x00,
	0x40, 0x40, 0x00, 0x40, 0x40, 0x00, 0x00, 0x00,
	0x60, 0x60, 0x00, 0x60, 0x60, 0x00, 0x00, 0x00,
	0x00, 0xf0, 0x00, 0xf0, 0x00, 0x00, 0x00, 0x00,
	0xa0, 0xa0, 0xa0, 0xa0, 0xa0, 0xa0, 0x00, 0x00,
	0x00, 0x70, 0x40, 0x70, 0x40, 0x40, 0x00, 0x00,
	0x00, 0x00, 0xf0, 0xa0, 0xa0, 0xa0, 0x00, 0x00,
	0x00, 0xf0, 0x80, 0xb0, 0xa0, 0xa0, 0x00, 0x00,
	0x00, 0xc0, 0x40, 0xc0, 0x40, 0x40, 0x00, 0x00,
	0x00, 0x00, 0xe0, 0xa0, 0xa0, 0xa0, 0x00, 0x00,
	0x00, 0x00, 0xe0, 0xa0, 0xa0, 0xa0, 0x00, 0x00,
	0x40, 0x70, 0x40, 0x70, 0x00, 0x00, 0x00, 0x00,
	0xa0, 0xa0, 0xf0, 0x00, 0x00, 0x00, 0x00, 0x00,
	0xa0, 0xb0, 0x80, 0xf0, 0x00, 0x00, 0x00, 0x00,
	0x40, 0xc0, 0x40, 0xc0, 0x00, 0x00, 0x00, 0x00,
	0xa0, 0xa0, 0xa0, 0xe0, 0x00, 0x00, 0x00, 0x00,
	0xa0, 0xa0, 0xa0, 0xe0, 0x00, 0x00, 0x00, 0x00,
	0x40, 0x70, 0x40, 0x70, 0x40, 0x40, 0x00, 0x00,
	0xa0, 0xa0, 0xb0, 0xa0, 0xa0, 0xa0, 0x00, 0x00,
	0xa0, 0xb0, 0x80, 0xb0, 0xa0, 0xa0, 0x00, 0x00,
	0x40, 0xc0, 0x40, 0xc0, 0x40, 0x40, 0x00, 0x00,
	0xa0, 0xa0, 0xa0, 0xa0, 0xa0, 0xa0, 0x00, 0x00,
	0xa0, 0xa0, 0x20, 0xa0, 0xa0, 0xa0, 0x00, 0x00,
	0x00, 0xf0, 0x00, 0xf0, 0x40, 0x40, 0x00, 0x00,
	0x00, 0x00, 0xf0, 0xa0, 0xa0, 0xa0, 0x00, 0x00,
	0x00, 0xf0, 0x00, 0xb0, 0xa0, 0xa0, 0x00, 0x00,
	0x40, 0xf0, 0x00, 0xf0, 0x00, 0x00, 0x00, 0x00,
	0xa0, 0xa0, 0xf0, 0x00, 0x00, 0x00, 0x00, 0x00,
	0xa0, 0xb0, 0x00, 0xf0, 0x00, 0x00, 0x00, 0x00,
	0x40, 0xf0, 0x40, 0xf0, 0x40, 0x40, 0x00, 0x00,
	0xa0, 0xa0, 0xf0, 0xa0, 0xa0, 0xa0, 0x00, 0x00,
	0xa0, 0xb0, 0x00, 0xb0, 0xa0, 0xa0, 0x00, 0x00,
	0x00, 0x00, 0x30, 0x40, 0x40, 0x40, 0x00, 0x00,
	0x00, 0x00, 0x80, 0x40, 0x40, 0x40, 0x00, 0x00,
	0x40, 0x40, 0x80, 0x00, 0x00, 0x00, 0x00, 0x00,
	0x40, 0x40, 0x30, 0x00, 0x00, 0x00, 0x00, 0x00,
	0x10, 0x10, 0x20, 0x40, 0x80, 0x80, 0x00, 0x00,
	0x80, 0x80, 0x40, 0x20, 0x10, 0x10, 0x00, 0x00,
	0x90, 0x90, 0x40, 0x20, 0x90, 0x90, 0x00, 0x00,
	0x00, 0x00, 0xc0, 0x00, 0x00, 0x00, 0x00, 0x00,
	0x40, 0x40, 0x40, 0x00, 0x00, 0x00, 0x00, 0x00,
	0x00, 0x00, 0x70, 0x00, 0x00, 0x00, 0x00, 0x00,
	0x00, 0x00, 0x40, 0x40, 0x40, 0x40, 0x00, 0x00,
	0x00, 0x00, 0xe0, 0xe0, 0x00, 0x00, 0x00, 0x00,
	0x60, 0x60, 0x60, 0x60, 0x00, 0x00, 0x00, 0x00,
	0x00, 0x00, 0x70, 0x70, 0x00, 0x00, 0x00, 0x00,
	0x00, 0x00, 0x60, 0x60, 0x60, 0x60, 0x00, 0x00,
	0x00, 0x00, 0xf0, 0x70, 0x00, 0x00, 0x00, 0x00,
	0x40, 0x40, 0x60, 0x60, 0x60, 0x60, 0x00, 0x00,
	0x00, 0x00, 0xf0, 0xe0, 0x00, 0x00, 0x00, 0x00,
	0x60, 0x60, 0x60, 0x60, 0x20, 0x20, 0x00, 0x00,
};

void draw_font(SDL_Surface* surface, const unsigned char* ptr, int x, int y, unsigned short color) {
	for (int ys = 0; (ys < 6) && (y + ys < surface->h); ptr++, ys++) {
		for (int xs = 0; (xs < 5) && (x + xs < surface->w); xs++) {
			if (*ptr & (1u << (8 - xs))) {
				((unsigned short*)surface->pixels)[(y + ys ) * (surface->w) + x + xs] = color;
			}
		}
	}
}

void draw_char(SDL_Surface* surface, unsigned char symbol, int x, int y, unsigned short color) {
	draw_font(surface, embedded_font + symbol * 8, x, y, color);
}

static const unsigned char unknown_font[] = {
	0x40, 0xe0, 0xe0, 0xe0, 0x40, 0x00, 0x00, 0x00,
};

void draw_unknown_char(SDL_Surface* surface, long utf8c, int x, int y, unsigned short color) {
	draw_font(surface, unknown_font, x, y, color);
}

void draw_string(SDL_Surface* surface, const char* text, int orig_x, int orig_y, unsigned short color) {
	int x = orig_x, y = orig_y;
	int count = 1;
	for (; *text; text++) {
		if (count-- > 1) continue;
		count = utf8size(text);
		if (count > 1){
			long utf8c;
			utf8decode(text, &utf8c);
			if ((utf8c & 0x1FFF80) == 0x2500) draw_font(surface, boxdrawing_font + (utf8c & 0x7F) * 8, x, y, color );
			else draw_font(surface, unknown_font, x, y, color);
			x += 4;
		} else {
			if(*text == '\n') {
				x = orig_x;
				y += 6;
			} else {
				draw_char(surface, *text, x, y, color);
				x += 4;
			}
		}
	}
}

static const unsigned char kb_font[] = {
	0x00, 0x40, 0xa0, 0xa0, 0x00, 0x00, 0x00, 0x00,
	0x00, 0xa0, 0xa0, 0x40, 0x00, 0x00, 0x00, 0x00,
};

void draw_kb_string(SDL_Surface* surface, const char* text, int orig_x, int orig_y, unsigned short color) {
	int x = orig_x, y = orig_y;
	while(*text) {
		if(*text == '\n') {
			x = orig_x;
			y += 6;
		} else if (*text >= 0x10 && *text < 0x12) {
			draw_font(surface, kb_font + (*text - 0x10) * 8, x, y, color);
			x += 4;
		} else {
			draw_char(surface, *text, x, y, color);
			x += 4;
		}
		text++;
	}
}
